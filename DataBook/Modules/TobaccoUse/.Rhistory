"2) Does not smoke other type of tobacco daily"))
library(srvyr)
STEPSClean <- df %>%
as_survey_design(ids=psu, strata=stratum, weights=wstep1, nest=TRUE)
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = T)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs")) %>%
filter(!is.na(c))
STEPSClean <- df %>%
as_survey_design(ids=psu, strata=stratum, weights=wstep1, nest=TRUE)
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs")) %>%
filter(!is.na(c))
df <- df %>%
mutate(cd = ifelse((t2==1 & t5a>0 & t5a<=50), "1) Smokes manufactured cigs daily",
"2) Does not smoke manufactured cigs daily")) %>%
filter(!is.na(cd))
df <- df %>%
mutate(d = ifelse((t2==1 & t5b>0 & t5b<=50) | (t5bw>0 & t5bw<=350), "1) Smokes hand-rolled cigs",
"2) Does not smoke hand-rolled cigs")) %>%
filter(!is.na(d))
df <- df %>%
mutate(dd = ifelse((t2==1 & t5b>0 & t5b<=50), "1) Smokes hand-rolled cigs daily",
"2) Does not smoke hand-rolled cigs daily")) %>%
filter(!is.na(dd))
df <- df %>%
mutate(e = ifelse((t2==1 & t5c>0 & t5c<=50) | (t5cw>0 & t5cw<=350), "1) Smokes pipes",
"2) Does not smoke pipes")) %>%
filter(!is.na(e))
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs"))
df <- data %>% select(c(
"agerange", "agerange2", "age", "sex", "valid", "ur", "region",
"t1", "t2", "t5a", "t5aw", "t5b", "t5bw", "t5c", "t5cw", "t5d", "t5dw",
"t5e", "t5ew", "t5f", "t5fw", "t5g", "t5gw",
"psu", "stratum", "wstep1"
))
# Changing the dash to an en dash in age ranges: "-" to "–"
# This is needed for the final output tables
unique(df$agerange)
unique(df$agerange2)
library(stringr)
df <- df %>%
mutate(across("agerange", str_replace, "-", "–")) %>%
mutate(across("agerange2", str_replace, "-", "–"))
# Including only those respondents that are valid==1
df <- subset(df, valid==1)
dim(df)
table(df$valid)
# Checking & remove NA values from wstep1, etc.
table(is.na(df$wstep1))
df <- df[!(is.na(df$wstep1)),]
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2, missing = 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1, missing = 2,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2, missing = 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2, missing = 2))
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs"))
df <- df %>%
mutate(cd = ifelse((t2==1 & t5a>0 & t5a<=50), "1) Smokes manufactured cigs daily",
"2) Does not smoke manufactured cigs daily"))
df <- df %>%
mutate(d = ifelse((t2==1 & t5b>0 & t5b<=50) | (t5bw>0 & t5bw<=350), "1) Smokes hand-rolled cigs",
"2) Does not smoke hand-rolled cigs"))
df <- df %>%
mutate(dd = ifelse((t2==1 & t5b>0 & t5b<=50), "1) Smokes hand-rolled cigs daily",
"2) Does not smoke hand-rolled cigs daily"))
df <- df %>%
mutate(e = ifelse((t2==1 & t5c>0 & t5c<=50) | (t5cw>0 & t5cw<=350), "1) Smokes pipes",
"2) Does not smoke pipes"))
df <- df %>%
mutate(ed = ifelse((t2==1 & t5c>0 & t5c<=50), "1) Smokes pipes daily",
"2) Does not smoke pipes daily"))
df <- df %>%
mutate(f = ifelse((t2==1 & t5d>0 & t5d<=50) | (t5dw>0 & t5dw<=350), "1) Smokes cigars",
"2) Does not smoke cigars"))
df <- df %>%
mutate(fd = ifelse((t2==1 & t5d>0 & t5d<=50), "1) Smokes cigars daily",
"2) Does not smoke cigars daily"))
df <- df %>%
mutate(g = ifelse((t2==1 & t5e>0 & t5e<=50) | (t5ew>0 & t5ew<=350), "1) Smokes shisha",
"2) Does not smoke shisha"))
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2))
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2)) %>%
filter(!is.na(cln))
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2, missing = 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1, missing = 2,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2, missing = 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2, missing = 2))
df <- data %>% select(c(
"agerange", "agerange2", "age", "sex", "valid", "ur", "region",
"t1", "t2", "t5a", "t5aw", "t5b", "t5bw", "t5c", "t5cw", "t5d", "t5dw",
"t5e", "t5ew", "t5f", "t5fw", "t5g", "t5gw",
"psu", "stratum", "wstep1"
))
# Changing the dash to an en dash in age ranges: "-" to "–"
# This is needed for the final output tables
unique(df$agerange)
unique(df$agerange2)
library(stringr)
df <- df %>%
mutate(across("agerange", str_replace, "-", "–")) %>%
mutate(across("agerange2", str_replace, "-", "–"))
# Including only those respondents that are valid==1
df <- subset(df, valid==1)
dim(df)
table(df$valid)
# Checking & remove NA values from wstep1, etc.
table(is.na(df$wstep1))
df <- df[!(is.na(df$wstep1)),]
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2, missing = 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1, missing = 2,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2, missing = 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2, missing = 2))
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2))
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs"))
df <- df %>%
mutate(cd = ifelse((t2==1 & t5a>0 & t5a<=50), "1) Smokes manufactured cigs daily",
"2) Does not smoke manufactured cigs daily"))
df <- df %>%
mutate(d = ifelse((t2==1 & t5b>0 & t5b<=50) | (t5bw>0 & t5bw<=350), "1) Smokes hand-rolled cigs",
"2) Does not smoke hand-rolled cigs"))
df <- df %>%
mutate(dd = ifelse((t2==1 & t5b>0 & t5b<=50), "1) Smokes hand-rolled cigs daily",
"2) Does not smoke hand-rolled cigs daily"))
df <- df %>%
mutate(e = ifelse((t2==1 & t5c>0 & t5c<=50) | (t5cw>0 & t5cw<=350), "1) Smokes pipes",
"2) Does not smoke pipes"))
df <- df %>%
mutate(ed = ifelse((t2==1 & t5c>0 & t5c<=50), "1) Smokes pipes daily",
"2) Does not smoke pipes daily"))
df <- df %>%
mutate(f = ifelse((t2==1 & t5d>0 & t5d<=50) | (t5dw>0 & t5dw<=350), "1) Smokes cigars",
"2) Does not smoke cigars"))
df <- df %>%
mutate(fd = ifelse((t2==1 & t5d>0 & t5d<=50), "1) Smokes cigars daily",
"2) Does not smoke cigars daily"))
df <- df %>%
mutate(g = ifelse((t2==1 & t5e>0 & t5e<=50) | (t5ew>0 & t5ew<=350), "1) Smokes shisha",
"2) Does not smoke shisha"))
df <- df %>%
mutate(gd = ifelse((t2==1 & t5e>0 & t5e<=50), "1) Smokes shisha daily",
"2) Does not smoke shisha daily"))
df <- df %>%
mutate(h = ifelse((t2==1 & t5f>0 & t5f<=50) | (t5fw>0 & t5fw<=350), "1) Smokes heated tobacco products (iQOS, etc.)",
"2) Does not smoke heated tobacco products (iQOS, etc.)"))
df <- df %>%
mutate(hd = ifelse((t2==1 & t5f>0 & t5f<=50), "1) Smokes heated tobacco products (iQOS, etc.) daily",
"2) Does not smoke heated tobacco products (iQOS, etc.) daily"))
df <- df %>%
mutate(i = ifelse((t2==1 & t5g>0 & t5g<=50) | (t5gw>0 & t5gw<=350), "1) Smokes other type of tobacco",
"2) Does not smoke other type of tobacco"))
df <- df %>%
mutate(id = ifelse((t2==1 & t5g>0 & t5g<=50), "1) Smokes other type of tobacco daily",
"2) Does not smoke other type of tobacco daily"))
library(srvyr)
STEPSClean <- df %>%
as_survey_design(ids=psu, strata=stratum, weights=wstep1, nest=TRUE)
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
filter(!is.na(c))
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men") %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
filter(!is.na(c)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"), na.rm = TRUE)) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2, missing = 2))
df <- data %>% select(c(
"agerange", "agerange2", "age", "sex", "valid", "ur", "region",
"t1", "t2", "t5a", "t5aw", "t5b", "t5bw", "t5c", "t5cw", "t5d", "t5dw",
"t5e", "t5ew", "t5f", "t5fw", "t5g", "t5gw",
"psu", "stratum", "wstep1"
))
# Changing the dash to an en dash in age ranges: "-" to "–"
# This is needed for the final output tables
unique(df$agerange)
unique(df$agerange2)
library(stringr)
df <- df %>%
mutate(across("agerange", str_replace, "-", "–")) %>%
mutate(across("agerange2", str_replace, "-", "–"))
# Including only those respondents that are valid==1
df <- subset(df, valid==1)
dim(df)
table(df$valid)
# Checking & remove NA values from wstep1, etc.
table(is.na(df$wstep1))
df <- df[!(is.na(df$wstep1)),]
df <- df %>%
mutate(t1cln = if_else(t1==1 | t1==2, 1, 2, missing = 2))
df <- df %>%
mutate(t2cln = if_else(t1==1 & (t2==1 | t2==2), 1, missing = 2,
if_else(t1==2 & (is.na(t2) | t2==2), 1, 2, missing = 2)))
df <- df %>%
mutate(cln = if_else(t1cln==1 & t2cln==1, 1, 2, missing = 2))
df <- df %>%
mutate(c = ifelse((t2==1 & t5a>0 & t5a<=50) | (t5aw>0 & t5aw<=350), "1) Smokes manufactured cigs",
"2) Does not smoke manufactured cigs"))
df <- df %>%
mutate(cd = ifelse((t2==1 & t5a>0 & t5a<=50), "1) Smokes manufactured cigs daily",
"2) Does not smoke manufactured cigs daily"))
df <- df %>%
mutate(d = ifelse((t2==1 & t5b>0 & t5b<=50) | (t5bw>0 & t5bw<=350), "1) Smokes hand-rolled cigs",
"2) Does not smoke hand-rolled cigs"))
df <- df %>%
mutate(dd = ifelse((t2==1 & t5b>0 & t5b<=50), "1) Smokes hand-rolled cigs daily",
"2) Does not smoke hand-rolled cigs daily"))
df <- df %>%
mutate(e = ifelse((t2==1 & t5c>0 & t5c<=50) | (t5cw>0 & t5cw<=350), "1) Smokes pipes",
"2) Does not smoke pipes"))
df <- df %>%
mutate(ed = ifelse((t2==1 & t5c>0 & t5c<=50), "1) Smokes pipes daily",
"2) Does not smoke pipes daily"))
df <- df %>%
mutate(f = ifelse((t2==1 & t5d>0 & t5d<=50) | (t5dw>0 & t5dw<=350), "1) Smokes cigars",
"2) Does not smoke cigars"))
df <- df %>%
mutate(fd = ifelse((t2==1 & t5d>0 & t5d<=50), "1) Smokes cigars daily",
"2) Does not smoke cigars daily"))
df <- df %>%
mutate(g = ifelse((t2==1 & t5e>0 & t5e<=50) | (t5ew>0 & t5ew<=350), "1) Smokes shisha",
"2) Does not smoke shisha"))
df <- df %>%
mutate(gd = ifelse((t2==1 & t5e>0 & t5e<=50), "1) Smokes shisha daily",
"2) Does not smoke shisha daily"))
df <- df %>%
mutate(h = ifelse((t2==1 & t5f>0 & t5f<=50) | (t5fw>0 & t5fw<=350), "1) Smokes heated tobacco products (iQOS, etc.)",
"2) Does not smoke heated tobacco products (iQOS, etc.)"))
df <- df %>%
mutate(hd = ifelse((t2==1 & t5f>0 & t5f<=50), "1) Smokes heated tobacco products (iQOS, etc.) daily",
"2) Does not smoke heated tobacco products (iQOS, etc.) daily"))
df <- df %>%
mutate(i = ifelse((t2==1 & t5g>0 & t5g<=50) | (t5gw>0 & t5gw<=350), "1) Smokes other type of tobacco",
"2) Does not smoke other type of tobacco"))
df <- df %>%
mutate(id = ifelse((t2==1 & t5g>0 & t5g<=50), "1) Smokes other type of tobacco daily",
"2) Does not smoke other type of tobacco daily"))
library(srvyr)
STEPSClean <- df %>%
as_survey_design(ids=psu, strata=stratum, weights=wstep1, nest=TRUE)
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(agerange, sex, c) %>%
summarise(n = unweighted(n()), # calculating n for individual answer choices
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#rename(variable = agerange) %>% # renaming with a common name for joining all tables later
mutate(n = sum(n)) %>% # replacing previous n with a sum of all answer choices
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))
) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
mutate(agerange = "18–69", .before = "sex") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cig") %>%
ungroup()
manuf_cig_m_t
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
mutate(agerange = "18–69", .before = "n") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cig") %>%
ungroup()
manuf_cig_m_t
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
mutate(agerange = "18–69", .before = "c") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cig") %>%
ungroup()
manuf_cig_m_t
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
#mutate(agerange = "18–69", .before = "c") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cig") %>%
ungroup()
manuf_cig_m_t
View(duration_m_t)
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
mutate(agerange = "18–69", .before = "c") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m_t
manuf_cig_m_t <- STEPSClean %>%
filter(cln == 1, t1==1, sex == "Men", !is.na(c)) %>%
group_by(sex, c) %>%
summarise(n = unweighted(n()),
mean = survey_mean(vartype = c("ci"))) %>%
mutate(mean = round(100 * mean,1)) %>%
mutate(mean_low = round(100 * mean_low,1)) %>%
mutate(mean_upp = round(100 * mean_upp,1)) %>%
unite("95% CI", mean_low, mean_upp, sep = "–", remove = TRUE) %>%
mutate(agerange = "18–69", .before = "sex") %>%
mutate(n = sum(n)) %>%
filter(c == "1) Smokes manufactured cigs") %>%
ungroup()
manuf_cig_m_t
